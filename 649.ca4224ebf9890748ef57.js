(self.webpackChunkfipe_salariometro=self.webpackChunkfipe_salariometro||[]).push([[649],{8532:(t,e,i)=>{"use strict";i.r(e),i.d(e,{BoletimModule:()=>P});var s=i(3013),o=i(8583),n=i(7930),l=i(665),r=i(8550);class u extends r.i{constructor(t=0,e="",i="",s="",o="",n="",l="",r){super(),this.idBoletim=t,this.nuMes=e,this.nuAno=i,this.dsTitulo=s,this.dsDetalhes=o,this.urlImagem=n,this.urlPdf=l,this.myImage=r}}var a=i(639),m=i(4494),c=i(327);let h=(()=>{class t extends c.e{constructor(t){super("api/Boletim",t),this.injector=t}getAllMes(){return this.http.get(`${this.url}/GetAllMes`)}getAllAnos(){return this.http.get(`${this.url}/GetAllAnos`)}postFile(t,e,i){return this.http.post(`${this.url}/UploadImagem/?nuAno='${t}'&nuMes='${e}`,i)}postUploadPdf(t,e,i){return this.http.post(`${this.url}/UploadPdf/?nuAno='${t}'&nuMes='${e}`,i)}}return t.\u0275fac=function(e){return new(e||t)(a.LFG(a.zs3))},t.\u0275prov=a.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var d=i(9344),p=i(9866),f=i(4719);const g=["imagem"],Z=["pdf"];function A(t,e){1&t&&(a.TgZ(0,"small",26),a._uU(1,"Inserir um titulo."),a.qZA())}function v(t,e){1&t&&(a.TgZ(0,"small"),a._uU(1,"Inserir maior quantidade de caracter"),a.qZA())}function T(t,e){1&t&&(a.TgZ(0,"small"),a._uU(1,"Inserir detalhes."),a.qZA())}function q(t,e){if(1&t&&(a.TgZ(0,"div",27),a.YNc(1,v,2,0,"small",28),a.YNc(2,T,2,0,"small",28),a.qZA()),2&t){const t=a.oxw();let e,i;a.xp6(1),a.Q6J("ngIf",null==(e=t.form.get("dsDetalhes"))||null==e.errors?null:e.errors.minLength),a.xp6(1),a.Q6J("ngIf",null==(i=t.form.get("dsDetalhes"))||null==i.errors?null:i.errors.required)}}function b(t,e){1&t&&(a.TgZ(0,"small"),a._uU(1,"Inserir imagem"),a.qZA())}function x(t,e){if(1&t&&(a.TgZ(0,"div",27),a.YNc(1,b,2,0,"small",28),a.qZA()),2&t){const t=a.oxw();let e;a.xp6(1),a.Q6J("ngIf",null==(e=t.form.get("urlImagem"))||null==e.errors?null:e.errors.required)}}function _(t,e){1&t&&(a.TgZ(0,"small",26),a._uU(1,"Inserir pdf."),a.qZA())}function U(t,e){if(1&t&&(a.TgZ(0,"option",29),a._uU(1),a.qZA()),2&t){const t=e.$implicit;a.Q6J("value",t),a.xp6(1),a.Oqu(t)}}function I(t,e){1&t&&(a.TgZ(0,"small",26),a._uU(1,"Inserir o ano."),a.qZA())}function w(t,e){if(1&t&&(a.TgZ(0,"option",29),a._uU(1),a.qZA()),2&t){const t=e.$implicit;a.Q6J("value",t.nuMes),a.xp6(1),a.hij(" ",t.dsMes," ")}}function M(t,e){1&t&&(a.TgZ(0,"small",26),a._uU(1,"Inserir o m\xeas."),a.qZA())}let J=(()=>{class t{constructor(t,e,i,s,o,n,r){this.route=t,this.fb=e,this.boletimService=i,this.router=s,this.toastr=o,this.spinner=n,this.sessionService=r,this.currentAction="",this.pageTitle="add",this.url="http://localhost:44321",this.item=new u,this.lista_mes=[],this.lista_mes_filtro=[],this.lista_ano_filtro=[],this.showConfirmacao=!1,this.form=this.fb.group({nuMes:[null,[l.kI.required]],nuAno:[null,[l.kI.required]],dsTitulo:[null,[l.kI.required]],dsDetalhes:[null,[l.kI.required]],urlImagem:[null,[l.kI.required]],urlPdf:[null,[l.kI.required]]}),this.combosLoad()}ngOnInit(){const t=JSON.parse(sessionStorage.getItem("sessao_usuario")||"{}");void 0===t.nmUsuario?this.router.navigate(["login"]):"Admin"!==t.dsPerfil&&this.router.navigate(["home"]),t.flAlteraSenha&&this.router.navigate(["senha"]),this.setCurrentAction(),this.initializeForm(),this.loadBoletins()}setCurrentAction(){"new"==this.route.snapshot.url[0].path?(this.currentAction="new",this.pageTitle="Adicionar Novo Boletim"):(this.currentAction="edit",this.pageTitle="Editar Boletim")}loadBoletins(){"edit"==this.currentAction&&(this.spinner.show(),this.route.params.subscribe(t=>{this.boletimService.getById(+t.id).subscribe(t=>{this.item=t,this.item.urlImagem="",this.item.urlPdf="",this.form.patchValue(this.item),this.spinner.hide()})}))}initializeForm(){this.boletimService.getAllMes().subscribe(t=>{this.lista_mes=this.lista_mes_filtro=t,this.boletimService.getAllAnos().subscribe(t=>{this.lista_ano=this.lista_ano_filtro=t,this.route.snapshot.paramMap.get("id")})})}combosLoad(){}cmbAno_Filter(t){this.lista_ano_filtro=this.lista_ano.filter(e=>-1!==e.nuAno.toString().toLowerCase().indexOf(t.toLowerCase()))}readUrl(t){if(t.target.files&&t.target.files[0]){var e=new FileReader;e.onload=t=>{this.url=t.target.result},e.readAsDataURL(t.target.files[0])}}editarBoletim(){if(this.showConfirmacao=!1,this.form.valid)this.buildBoletim(),this.spinner.show(),this.boletimService.update(this.item,this.item.idBoletim).subscribe(t=>{if(this.toastr.success("Boletim atualizado sucesso!"),!0===t.confirmacao){if(this.showConfirmacao=!0,""!==this.item.urlPdf){let t=this.pdf.nativeElement.files[0],e=new FormData;e.append(t.name,t),this.boletimService.postUploadPdf(this.item.nuAno,this.item.nuMes,e).subscribe(t=>{},t=>this.toastr.error("deu ruim!"))}if(this.item.urlImagem){let t=this.imagem.nativeElement.files[0]||null,e=new FormData;e.append(t.name,t),this.boletimService.postFile(this.item.nuAno,this.item.nuMes,e).subscribe(t=>{})}this.fnLimpar()}this.spinner.hide(),this.router.navigate(["boletim"])},t=>{this.toastr.error("Ocorreu um erro no processo, verifique se os dados est\xe3o corretos!")});else for(let t in this.form.controls)this.form.controls[t].markAsTouched()}onSubmited(){"new"==this.currentAction?this.fnSalvar():this.editarBoletim()}buildBoletim(){var t,e,i,s,o,n;this.item.dsTitulo=(null===(t=this.form.controls.dsTitulo)||void 0===t?void 0:t.value)||"",this.item.dsDetalhes=(null===(e=this.form.controls.dsDetalhes)||void 0===e?void 0:e.value)||"",this.item.nuAno=(null===(i=this.form.controls.nuAno)||void 0===i?void 0:i.value)||"",this.item.nuMes=(null===(s=this.form.controls.nuMes)||void 0===s?void 0:s.value)||"",this.item.urlImagem=(null===(o=this.imagem.nativeElement.files[0])||void 0===o?void 0:o.name)||"",this.item.urlPdf=(null===(n=this.pdf.nativeElement.files[0])||void 0===n?void 0:n.name)||""}fnSalvar(){if(this.showConfirmacao=!1,this.form.valid)this.spinner.show(),this.buildBoletim(),this.boletimService.create(this.item).subscribe(t=>{if(!0===t.confirmacao){if(this.showConfirmacao=!0,""!==this.item.urlPdf){let t=this.pdf.nativeElement.files[0],e=new FormData;e.append(t.name,t),this.boletimService.postUploadPdf(this.item.nuAno,this.item.nuMes,e).subscribe(t=>{})}if(this.item.urlImagem){let t=this.imagem.nativeElement.files[0]||null,e=new FormData;e.append(t.name,t),this.boletimService.postFile(this.item.nuAno,this.item.nuMes,e).subscribe(t=>{})}this.spinner.hide(),this.toastr.success("Boletim salvo com sucesso!"),this.router.navigate(["boletim"]),this.fnLimpar()}});else for(let t in this.form.controls)this.form.controls[t].markAsTouched()}fnLimpar(){this.item.nuMes="",this.item.nuAno="",this.item.dsTitulo="",this.item.dsDetalhes="",this.item.urlImagem="",this.item.urlPdf="",this.form.reset()}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(m.gz),a.Y36(l.qu),a.Y36(h),a.Y36(m.F0),a.Y36(d._W),a.Y36(p.t2),a.Y36(f.m))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-boletim-form"]],viewQuery:function(t,e){if(1&t&&(a.Gf(g,5),a.Gf(Z,5)),2&t){let t;a.iGM(t=a.CRH())&&(e.imagem=t.first),a.iGM(t=a.CRH())&&(e.pdf=t.first)}},decls:45,vars:11,consts:[[1,"h3","pl-2","mb-4"],[1,"content"],["enctype","multipart/form-data",3,"formGroup"],[1,"form-group","col-10","col-md-6"],["type","text","formControlName","dsTitulo",1,"form-control"],["class","text-danger d-block mt-2",4,"ngIf"],["type","text","formControlName","dsDetalhes",1,"form-control"],["class","text-danger",4,"ngIf"],[1,"form-group","col-8","col-md-6"],["type","file","accept","image/x-png,image/gif,image/jpeg","formControlName","urlImagem","id","validationDefault04",1,"form-control",3,"change"],["imagem",""],[1,"form-group","col-6"],["for","validationDefault05"],["type","file","accept","application/pdf","formControlName","urlPdf","id","validationDefault05",1,"form-control"],["pdf",""],[1,"form-row"],[1,"form-group","pl-3","col-3"],["for","validationDefault01"],["valuePrimitive","true","formControlName","nuAno","data","lista_ano","type","text",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"form-group","col-3"],["for","validationDefault02"],["valuePrimitive","true","formControlName","nuMes","id","nuMes","data","lista_mes","type","text",1,"form-control"],[1,"col-6","d-flex","justify-content-between"],["type","button",1,"btn","btn-secondary","mr-5","w-25",3,"click"],["type","button",1,"btn","btn-success","w-25",3,"disabled","click"],[1,"text-danger","d-block","mt-2"],[1,"text-danger"],[4,"ngIf"],[3,"value"]],template:function(t,e){if(1&t&&(a.TgZ(0,"h3",0),a._uU(1),a.qZA(),a.TgZ(2,"div",1),a.TgZ(3,"form",2),a.TgZ(4,"div",3),a.TgZ(5,"label"),a._uU(6,"T\xedtulo"),a.qZA(),a._UZ(7,"input",4),a.YNc(8,A,2,0,"small",5),a.qZA(),a.TgZ(9,"div",3),a.TgZ(10,"label"),a._uU(11,"Detalhes"),a.qZA(),a._UZ(12,"textarea",6),a.YNc(13,q,3,2,"div",7),a.qZA(),a.TgZ(14,"div",8),a.TgZ(15,"label"),a._uU(16,"Imagem"),a.qZA(),a.TgZ(17,"input",9,10),a.NdJ("change",function(t){return e.readUrl(t)}),a.qZA(),a.YNc(19,x,2,1,"div",7),a.qZA(),a.TgZ(20,"div",11),a.TgZ(21,"label",12),a._uU(22,"Pdf"),a.qZA(),a._UZ(23,"input",13,14),a.YNc(25,_,2,0,"small",5),a.qZA(),a.TgZ(26,"div",15),a.TgZ(27,"div",16),a.TgZ(28,"label",17),a._uU(29,"Ano"),a.qZA(),a.TgZ(30,"select",18),a.YNc(31,U,2,2,"option",19),a.qZA(),a.YNc(32,I,2,0,"small",5),a.qZA(),a.TgZ(33,"div",20),a.TgZ(34,"label",21),a._uU(35,"M\xeas"),a.qZA(),a.TgZ(36,"select",22),a.YNc(37,w,2,2,"option",19),a.qZA(),a.YNc(38,M,2,0,"small",5),a.qZA(),a.qZA(),a.TgZ(39,"div",23),a.TgZ(40,"button",24),a.NdJ("click",function(){return e.fnLimpar()}),a._uU(41," Limpar "),a.qZA(),a.TgZ(42,"button",25),a.NdJ("click",function(){return e.onSubmited()}),a._uU(43," Salvar "),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a._UZ(44,"ngx-spinner")),2&t){let t,i,s,o,n,l;a.xp6(1),a.Oqu(e.pageTitle),a.xp6(2),a.Q6J("formGroup",e.form),a.xp6(5),a.Q6J("ngIf",(null==(t=e.form.get("dsTitulo"))||null==t.errors?null:t.errors.required)&&(null==(t=e.form.get("dsTitulo"))?null:t.touched)),a.xp6(5),a.Q6J("ngIf",(null==(i=e.form.get("dsDetalhes"))?null:i.invalid)&&(null==(i=e.form.get("dsDetalhes"))?null:i.touched)),a.xp6(6),a.Q6J("ngIf",(null==(s=e.form.get("dsDetalhes"))?null:s.invalid)&&(null==(s=e.form.get("dsDetalhes"))?null:s.touched)),a.xp6(6),a.Q6J("ngIf",(null==(o=e.form.get("urlPdf"))||null==o.errors?null:o.errors.required)&&(null==(o=e.form.get("urlPdf"))?null:o.touched)),a.xp6(6),a.Q6J("ngForOf",e.lista_ano),a.xp6(1),a.Q6J("ngIf",(null==(n=e.form.get("nuAno"))||null==n.errors?null:n.errors.required)&&(null==(n=e.form.get("nuAno"))?null:n.touched)),a.xp6(5),a.Q6J("ngForOf",e.lista_mes),a.xp6(1),a.Q6J("ngIf",(null==(l=e.form.get("nuMes"))||null==l.errors?null:l.errors.required)&&(null==(l=e.form.get("nuMes"))?null:l.touched)),a.xp6(4),a.Q6J("disabled",!e.form.valid)}},directives:[l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,o.O5,l.EJ,o.sg,p.Ro,l.YN,l.Kr],styles:[""]}),t})();var S=i(3473),C=i(3928);function N(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"tr"),a.TgZ(1,"th",12),a._uU(2," Titulo "),a._UZ(3,"p-sortIcon",13),a.qZA(),a.TgZ(4,"th",14),a._uU(5," Detalhes "),a._UZ(6,"p-sortIcon",15),a.qZA(),a.TgZ(7,"th",16),a._uU(8," Ano "),a._UZ(9,"p-sortIcon",17),a.qZA(),a.TgZ(10,"th",18),a._uU(11," Mes "),a._UZ(12,"p-sortIcon",19),a.qZA(),a.TgZ(13,"th",20),a._uU(14,"A\xe7\xf5es"),a.qZA(),a.qZA(),a.TgZ(15,"tr"),a.TgZ(16,"th"),a.TgZ(17,"input",21),a.NdJ("input",function(e){let i;return a.CHM(t),a.oxw(),a.MAs(9).filter(null==(i=e.target)?null:i.value,"dsTitulo","contains")}),a.qZA(),a.qZA(),a.TgZ(18,"th"),a.TgZ(19,"input",22),a.NdJ("input",function(e){let i;return a.CHM(t),a.oxw(),a.MAs(9).filter(null==(i=e.target)?null:i.value,"dsDetalhes","contains")}),a.qZA(),a.qZA(),a.TgZ(20,"th"),a.TgZ(21,"input",23),a.NdJ("input",function(e){let i;return a.CHM(t),a.oxw(),a.MAs(9).filter(null==(i=e.target)?null:i.value,"nuAno","contains")}),a.qZA(),a.qZA(),a.TgZ(22,"th"),a.TgZ(23,"input",24),a.NdJ("input",function(e){let i;return a.CHM(t),a.oxw(),a.MAs(9).filter(null==(i=e.target)?null:i.value,"nuMes","contains")}),a.qZA(),a.qZA(),a._UZ(24,"th"),a.qZA()}if(2&t){a.oxw();const t=a.MAs(9);a.xp6(17),a.Q6J("value",null==t.filters.dsTitulo?null:t.filters.dsTitulo.value),a.xp6(2),a.Q6J("value",null==t.filters.dsDetalhes?null:t.filters.dsDetalhes.value),a.xp6(2),a.Q6J("value",null==t.filters.nuAno?null:t.filters.nuAno.value),a.xp6(2),a.Q6J("value",null==t.filters.nuMes?null:t.filters.nuMes.value)}}const y=function(t){return["edit",t]};function D(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"tr",25),a.TgZ(1,"td"),a.TgZ(2,"strong"),a._uU(3),a.qZA(),a.qZA(),a.TgZ(4,"td"),a.TgZ(5,"span",26),a._uU(6,"Detalhes"),a.qZA(),a.TgZ(7,"span",27),a._uU(8),a.qZA(),a.qZA(),a.TgZ(9,"td",28),a.TgZ(10,"span",26),a._uU(11,"Ano"),a.qZA(),a.TgZ(12,"span",29),a._uU(13),a.qZA(),a.qZA(),a.TgZ(14,"td",28),a.TgZ(15,"span",26),a._uU(16,"M\xeas"),a.qZA(),a.TgZ(17,"span",29),a._uU(18),a.qZA(),a.qZA(),a.TgZ(19,"td",28),a.TgZ(20,"button",30),a._uU(21,"Editar"),a.qZA(),a.TgZ(22,"button",31),a.NdJ("click",function(){const e=a.CHM(t).$implicit;return a.oxw().confirm(e.idBoletim)}),a._uU(23,"Excluir"),a.qZA(),a.qZA(),a.qZA()}if(2&t){const t=e.$implicit;a.Q6J("pSelectableRow",t),a.xp6(3),a.hij(" ",t.dsTitulo," "),a.xp6(5),a.Oqu(t.dsDetalhes),a.xp6(5),a.Oqu(t.nuAno),a.xp6(5),a.Oqu(t.nuMes),a.xp6(2),a.Q6J("routerLink",a.VKq(6,y,t.idBoletim))}}function Y(t,e){1&t&&(a.TgZ(0,"tr"),a.TgZ(1,"td",32),a._uU(2,"N\xe3o foram encontrados Boletins."),a.qZA(),a.qZA())}const B=[{path:"",component:(()=>{class t{constructor(t,e,i,s,o,n,l){this.confirmationService=t,this.boletimService=e,this.messageService=i,this.toastr=s,this.spinner=o,this.sessionService=n,this.router=l,this.msgs=[]}ngOnInit(){const t=JSON.parse(sessionStorage.getItem("sessao_usuario")||"{}");void 0===t.nmUsuario?this.router.navigate(["login"]):"Admin"!==t.dsPerfil&&this.router.navigate(["home"]),t.flAlteraSenha&&this.router.navigate(["senha"]),this.carregarBoletins()}carregarBoletins(){this.spinner.show(),this.boletimService.getAll().subscribe(t=>{this.spinner.hide(),this.boletins=t},t=>{})}confirm(t){this.confirmationService.confirm({message:"Tem certeza que deseja remover este boletim?",accept:()=>{this.spinner.show(),this.boletimService.delete(t).subscribe(t=>{this.toastr.success("O boletim foi removido com sucesso"),this.spinner.hide(),this.messageService.add({severity:"success",summary:"excluido com sucesso"}),this.carregarBoletins()},t=>{this.toastr.error("Ocorreu um erro no processo, tente novamente em alguns minutos!"),this.spinner.hide(),confirm})},reject:()=>{}})}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(s.YP),a.Y36(h),a.Y36(s.ez),a.Y36(d._W),a.Y36(p.t2),a.Y36(f.m),a.Y36(m.F0))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-boletim-list"]],decls:15,vars:5,consts:[[1,"row","mb-5"],[1,"col-md-6"],[1,"h2"],[1,"col","md-6"],["routerLink","new",1,"btn","btn-primary","float-right"],[1,"card"],["selectionMode","single","dataKey","id","styleClass","p-datatable-gridlines",3,"value","selection","responsive","rows","paginator","selectionChange"],["dt1",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["lang","pt-BR","header","Confirma\xe7\xe3o","icon","pi pi-exclamation-triangle"],["pSortableColumn","dsTitulo",1,"text-center"],["field","name"],["pSortableColumn","dsDetalhes",1,"text-center"],["field","dsDetalhes"],["pSortableColumn","nuAno",1,"text-center"],["field","nuAno"],["pSortableColumn","nuMes",1,"text-center"],["field","nuMes"],["pSortableColumn","actions",1,"text-center"],["pInputText","","type","text","placeholder","pesquisar titulo",1,"p-column-filter","form-control-plaintext",3,"value","input"],["pInputText","","type","text","placeholder","pesquisar detalhes",1,"p-column-filter","form-control-plaintext",3,"value","input"],["pInputText","","type","text","placeholder","pesquisar por ano",1,"p-column-filter","form-control-plaintext",3,"value","input"],["pInputText","","type","text","placeholder","pesquisar por m\xeas",1,"p-column-filter","form-control-plaintext",3,"value","input"],[3,"pSelectableRow"],[1,"p-column-title"],[1,"image-text","text-center"],[1,"text-center"],[1,"image-text"],[1,"btn","btn-primary","mr-4",3,"routerLink"],[1,"btn","btn-danger",3,"click"],["colspan","4"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"h1",2),a._uU(3,"Boletim"),a.qZA(),a.qZA(),a.TgZ(4,"div",3),a.TgZ(5,"button",4),a._uU(6,"Adicionar Boletim +"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(7,"div",5),a.TgZ(8,"p-table",6,7),a.NdJ("selectionChange",function(t){return e.selectedBoletins=t}),a.YNc(10,N,25,4,"ng-template",8),a.YNc(11,D,24,8,"ng-template",9),a.YNc(12,Y,3,0,"ng-template",10),a.qZA(),a.qZA(),a._UZ(13,"p-confirmDialog",11),a._UZ(14,"ngx-spinner")),2&t&&(a.xp6(8),a.Q6J("value",e.boletins)("selection",e.selectedBoletins)("responsive",!0)("rows",5)("paginator",!0))},directives:[m.rH,n.iA,s.jx,S.Q,p.Ro,n.lQ,n.fz,C.o,n.Ei],styles:[""]}),t})()},{path:"new",component:J},{path:"edit/:id",component:J}];let Q=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[m.Bz.forChild(B)],m.Bz]}),t})();var k=i(4207),F=i(3758);let P=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({providers:[s.YP],imports:[[o.ez,Q,l.UX,S.D,k.hJ,s.m8,F.$,p.ef,n.U$,C.j]]}),t})()}}]);